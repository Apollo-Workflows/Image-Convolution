<Workflow name="IMGREC"><Array as="dataIns"><DataIns name="s3bucket" type="string" source="s3bucket"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="topic_arn" type="string" source="topic_arn"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="desired_num_splits" type="number" source="desired_num_splits"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="s3prefix" type="string" source="s3prefix"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="region" type="string" source="region"><Array as="properties"/><Array as="constraints"/></DataIns></Array><Array as="dataOuts"><DataOuts name="average_deviation" type="number" source="ir-reduce/average_deviation"><Array as="properties"/><Array as="constraints"/></DataOuts></Array><Array as="body"><Cell id="0"/><Cell id="1" parent="0"/><Cell id="4" value="Start" style="start" type="start" parent="1" vertex="1"><mxGeometry x="154" y="48" width="40" height="40" as="geometry"/></Cell><Cell id="5" style="fn" type="AtomicFunction" parent="1" vertex="1"><AtomicFunction name="ir-split" type="String" as="value"><Array as="properties"><Object name="resource" value="arn:aws:lambda:us-east-2:735406098573:function:ir-split"/></Array><Array as="constraints"/><Array as="dataIns"><DataIns name="s3bucket" type="string" source="IMGREC/s3bucket"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="desired_num_splits" type="number" source="IMGREC/desired_num_splits"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="s3prefix" type="string" source="IMGREC/s3prefix"><Array as="properties"/><Array as="constraints"/></DataIns></Array><Array as="dataOuts"><DataOuts name="batches" type="collection"><Array as="properties"/><Array as="constraints"/></DataOuts><DataOuts name="num_splits" type="number"><Array as="properties"/><Array as="constraints"/></DataOuts></Array></AtomicFunction><mxGeometry x="130" y="112" width="88" height="32" as="geometry"/></Cell><Cell id="6" style="parallelFor" type="ParallelFor" parent="1" vertex="1"><ParallelFor name="ParallelFor" as="value"><Array as="properties"/><Array as="constraints"/><Array as="dataIns"><DataIns name="images_s3_keys" type="collection" source="ir-split/batches"><Array as="properties"/><Array as="constraints"><Object name="distribution" value="BLOCK(1)"/></Array></DataIns><DataIns name="s3bucket" type="string" source="IMGREC/s3bucket"><Array as="properties"/><Array as="constraints"><Object name="distribution" value="REPLICATE(*)"/></Array></DataIns><DataIns name="topic_arn" type="string" source="IMGREC/topic_arn"><Array as="properties"/><Array as="constraints"><Object name="distribution" value="REPLICATE(*)"/></Array></DataIns><DataIns name="region" type="string" source="IMGREC/region"><Array as="properties"/><Array as="constraints"/></DataIns></Array><Array as="dataOuts"><DataOuts name="invalid_units_frame_keys_batches" type="collection" source="ir-convolute-reduce/invalid_units_frame_keys"><Array as="properties"/><Array as="constraints"/></DataOuts><DataOuts name="invalid_units_frame_timestamps_batches" type="collection" source="ir-convolute-reduce/invalid_units_timestamps"><Array as="properties"/><Array as="constraints"/></DataOuts><DataOuts name="ingested_frame_keys_batches" type="collection" source="ir-convolute-reduce/ingested_frame_keys"><Array as="properties"/><Array as="constraints"/></DataOuts><DataOuts name="ingested_frame_timestamps_batches" type="collection" source="ir-convolute-reduce/ingested_frame_timestamps"><Array as="properties"/><Array as="constraints"/></DataOuts></Array><LoopCounter type="number" to="ir-split/num_splits" step="1" as="loopCounter"/></ParallelFor><mxGeometry x="48" y="172" width="248" height="232" as="geometry"/></Cell><Cell id="7" style="fn" type="AtomicFunction" parent="6" vertex="1"><AtomicFunction name="ir-convolute-reduce" type="String" as="value"><Array as="properties"><Object name="resource" value="arn:aws:lambda:us-east-2:735406098573:function:ir-convolute-reduce"/></Array><Array as="constraints"/><Array as="dataIns"><DataIns name="cropped_images_s3_keys" type="collection" source="preprocess-imgs/cropped_images_s3_keys"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="cropped_images_timestamps" type="collection" source="preprocess-imgs/cropped_images_timestamps"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="s3bucket" type="string" source="ParallelFor/s3bucket"><Array as="properties"/><Array as="constraints"/></DataIns></Array><Array as="dataOuts"><DataOuts name="all_passed" type="bool"><Array as="properties"/><Array as="constraints"/></DataOuts><DataOuts name="invalid_units_frame_keys" type="collection"><Array as="properties"/><Array as="constraints"/></DataOuts><DataOuts name="invalid_units_timestamps" type="collection"><Array as="properties"/><Array as="constraints"/></DataOuts><DataOuts name="ingested_frame_keys" type="collection"><Array as="properties"/><Array as="constraints"/></DataOuts><DataOuts name="ingested_frame_timestamps" type="collection"><Array as="properties"/><Array as="constraints"/></DataOuts></Array></AtomicFunction><mxGeometry x="80" y="88" width="88" height="32" as="geometry"/></Cell><Cell id="10" style="fn" type="AtomicFunction" parent="6" vertex="1"><AtomicFunction name="preprocess-imgs" type="String" as="value"><Array as="properties"><Object name="resource" value="arn:aws:lambda:us-east-2:735406098573:function:preprocess-imgs"/></Array><Array as="constraints"/><Array as="dataIns"><DataIns name="images_s3_keys" type="collection" source="ParallelFor/images_s3_keys"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="s3bucket" type="string" source="ParallelFor/s3bucket"><Array as="properties"/><Array as="constraints"/></DataIns></Array><Array as="dataOuts"><DataOuts name="cropped_images_s3_keys" type="collection"><Array as="properties"/><Array as="constraints"/></DataOuts><DataOuts name="cropped_images_timestamps" type="collection"><Array as="properties"/><Array as="constraints"/></DataOuts></Array></AtomicFunction><mxGeometry x="80" y="24" width="88" height="32" as="geometry"/></Cell><Cell id="25" style="fn" type="AtomicFunction" parent="6" vertex="1"><AtomicFunction name="ir-log-unit" type="String" as="value"><Array as="properties"><Object name="resource" value="arn:aws:lambda:us-east-2:735406098573:function:ir-log-unit"/></Array><Array as="constraints"/><Array as="dataIns"><DataIns name="all_passed" type="bool" source="ir-convolute-reduce/all_passed"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="invalid_units_frame_keys" type="collection" source="ir-convolute-reduce/invalid_units_frame_keys"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="invalid_units_timestamps" type="collection" source="ir-convolute-reduce/invalid_units_timestamps"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="ingested_frame_keys" type="collection" source="ir-convolute-reduce/ingested_frame_keys"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="ingested_frame_timestamps" type="collection" source="ir-convolute-reduce/ingested_frame_timestamps"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="topic_arn" type="string" source="ParallelFor/topic_arn"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="region" type="string" source="ParallelFor/region"><Array as="properties"/><Array as="constraints"/></DataIns></Array><Array as="dataOuts"/></AtomicFunction><mxGeometry x="84" y="168" width="88" height="32" as="geometry"/></Cell><Cell id="41" style="sourcePort=out;targetPort=in;" parent="6" source="10" target="7" edge="1"><mxGeometry relative="1" as="geometry"/></Cell><Cell id="47" style="sourcePort=out;targetPort=in;" edge="1" parent="6" source="7" target="25"><mxGeometry relative="1" as="geometry"/></Cell><Cell id="12" style="fn" type="AtomicFunction" parent="1" vertex="1"><AtomicFunction name="ir-reduce" type="String" as="value"><Array as="properties"><Object name="resource" value="arn:aws:lambda:us-east-2:735406098573:function:ir-reduce"/></Array><Array as="constraints"/><Array as="dataIns"><DataIns name="invalid_units_frame_keys_batches" type="collection" source="ParallelFor/invalid_units_frame_keys_batches"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="invalid_units_frame_timestamps_batches" type="collection" source="ParallelFor/invalid_units_frame_timestamps_batches"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="ingested_frame_keys_batches" type="collection" source="ParallelFor/ingested_frame_keys_batches"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="ingested_frame_timestamps_batches" type="collection" source="ParallelFor/ingested_frame_timestamps_batches"><Array as="properties"/><Array as="constraints"/></DataIns></Array><Array as="dataOuts"><DataOuts name="average_deviation" type="number"><Array as="properties"/><Array as="constraints"/></DataOuts></Array></AtomicFunction><mxGeometry x="130" y="444" width="88" height="32" as="geometry"/></Cell><Cell id="17" value="End" style="end" type="end" parent="1" vertex="1"><mxGeometry x="152" y="740" width="40" height="40" as="geometry"/></Cell><Cell id="30" style="cond" type="IfThenElse" parent="1" vertex="1"><IfThenElse name="IfThenElse1" as="value"><Array as="properties"/><Array as="constraints"/><Array as="dataIns"><DataIns name="average_deviation" type="number" source="ir-reduce/average_deviation"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="invalid_units_frame_keys_batches" type="collection" source="ParallelFor/invalid_units_frame_keys_batches"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="invalid_units_frame_timestamps_batches" type="collection" source="ParallelFor/invalid_units_frame_timestamps_batches"><Array as="properties"/><Array as="constraints"/></DataIns></Array><Array as="dataOuts"/><CompositeCondition combinedWith="and" as="condition"><Array as="conditions"><Condition data1="IfThenElse1/average_deviation" data2="1" operator="&lt;"/></Array></CompositeCondition></IfThenElse><mxGeometry x="150" y="516" width="44" height="44" as="geometry"/></Cell><Cell id="32" style="fn" type="AtomicFunction" parent="1" vertex="1"><AtomicFunction name="log-valid-batch" type="String" as="value"><Array as="properties"><Object name="resource" value="arn:aws:lambda:us-east-2:735406098573:function:ir-log-batch-valid"/></Array><Array as="constraints"/><Array as="dataIns"><DataIns name="average_deviation" type="collection" source="IfThenElse1/average_deviation"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="topic_arn" type="string" source="IMGREC/topic_arn"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="region" type="string" source="IMGREC/region"><Array as="properties"/><Array as="constraints"/></DataIns></Array><Array as="dataOuts"/></AtomicFunction><mxGeometry x="194" y="600" width="88" height="32" as="geometry"/></Cell><Cell id="33" style="fn" type="AtomicFunction" parent="1" vertex="1"><AtomicFunction name="log-invalid-batch" type="String" as="value"><Array as="properties"><Object name="resource" value="arn:aws:lambda:us-east-2:735406098573:function:ir-log-batch-invalid"/></Array><Array as="constraints"/><Array as="dataIns"><DataIns name="average_deviation" type="number" source="IfThenElse1/average_deviation"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="invalid_units_frame_keys_batches" type="collection" source="IfThenElse1/invalid_units_frame_keys_batches"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="invalid_units_frame_timestamps_batches" type="collection" source="IfThenElse1/invalid_units_frame_timestamps_batches"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="topic_arn" type="string" source="IMGREC/topic_arn"><Array as="properties"/><Array as="constraints"/></DataIns><DataIns name="region" type="string" source="IMGREC/region"><Array as="properties"/><Array as="constraints"/></DataIns></Array><Array as="dataOuts"/></AtomicFunction><mxGeometry x="80" y="600" width="88" height="32" as="geometry"/></Cell><Cell id="37" value="merge" style="merge" type="merge" parent="1" vertex="1"><mxGeometry x="160" y="684" width="28" height="20" as="geometry"/></Cell><Cell id="21" style="sourcePort=out;targetPort=in;" parent="1" source="4" target="5" edge="1"><mxGeometry relative="1" as="geometry"><Array as="points"/></mxGeometry></Cell><Cell id="22" style="sourcePort=out;targetPort=in;" parent="1" source="5" target="6" edge="1"><mxGeometry relative="1" as="geometry"><Array as="points"/></mxGeometry></Cell><Cell id="23" style="sourcePort=out;targetPort=in;" parent="1" source="6" target="12" edge="1"><mxGeometry relative="1" as="geometry"/></Cell><Cell id="31" style="sourcePort=out;targetPort=in;" parent="1" source="12" target="30" edge="1"><mxGeometry relative="1" as="geometry"/></Cell><Cell id="34" value="else" style="sourcePort=else;targetPort=in;" parent="1" source="30" target="33" edge="1"><mxGeometry relative="1" as="geometry"/></Cell><Cell id="35" value="then" style="sourcePort=then;targetPort=in;" parent="1" source="30" target="32" edge="1"><mxGeometry relative="1" as="geometry"/></Cell><Cell id="38" style="sourcePort=out;targetPort=in;" parent="1" source="32" target="37" edge="1"><mxGeometry relative="1" as="geometry"/></Cell><Cell id="39" style="sourcePort=out;targetPort=in;" parent="1" source="33" target="37" edge="1"><mxGeometry relative="1" as="geometry"/></Cell><Cell id="40" style="sourcePort=out;targetPort=in;" parent="1" source="37" target="17" edge="1"><mxGeometry relative="1" as="geometry"/></Cell></Array></Workflow>